(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1fd0f9c6"],{"53d8":function(e,t,a){},"6efb":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"view-wrapper",style:{height:e.pageMixin_browser.clientHeight}},[a("DP_Popup",{attrs:{display:e.popup.show,"show-close":!0,"background-color":"white",title:e.popup.title},on:{"update:display":function(t){return e.$set(e.popup,"show",t)}}},[a("img",{staticClass:"qrcode",attrs:{src:e.pageQrcode_img,alt:""}}),a("div",[e._v("请打开微信扫一扫")])]),a("div",{staticClass:"content"},[a("img",{directives:[{name:"show",rawName:"v-show",value:e.parameter.avatar,expression:"parameter.avatar"}],ref:"avatar",staticClass:"avatar",attrs:{width:"100px",crossorigin:"anonymous",src:e.parameter.avatar,alt:""}}),[a("div",{ref:"posterWrapper",staticClass:"poster-wrapper"},[a("img",{directives:[{name:"show",rawName:"v-show",value:e.output_img,expression:"output_img"}],ref:"poster_output",staticClass:"poster_output",attrs:{src:e.output_img,alt:""}}),a("img",{directives:[{name:"show",rawName:"v-show",value:!e.output_img,expression:"!output_img"}],ref:"poster",staticClass:"origin",attrs:{crossorigin:"anonymous",src:e.parameter.poster,alt:""}}),a("canvas",{ref:"canvas",attrs:{id:"canvas"}})])],""===e.output_img?a("div",{staticClass:"in-development"},[e._v(e._s(e.tips))]):e._e()],2),e.pageMixin_browser.device.isDPApp&&e.output_img?a("div",{staticClass:"share-in-app"},[a("div",{staticClass:"option-wrapper"},[a("a",{staticClass:"option",attrs:{href:"uniwebview://wechatsharetofriend?image="+e.output_img}},[a("div",{staticClass:"icon friend"}),a("div",{staticClass:"label"},[e._v("微信")])]),a("a",{staticClass:"option",attrs:{href:"uniwebview://wechatsharetomoments?image="+e.output_img}},[a("div",{staticClass:"icon moment"}),a("div",{staticClass:"label"},[e._v("朋友圈")])]),a("a",{staticClass:"option"},[a("div",{staticClass:"icon scan",on:{click:e.openPopup}}),a("div",{staticClass:"label"},[e._v("扫码")])])])]):e._e(),e.pageMixin_browser.device.isWechat&&e.output_img?a("div",{staticClass:"share-in-wechat"},[a("div",{staticClass:"arrow"}),a("div",{staticClass:"tips"},[e._v("长按上图保存到相册，分享给好友")])]):e._e()],1)},r=[],i=(a("b0c0"),a("d3b7"),a("96cf"),a("1da1")),n=a("5530"),o=a("f586"),c=a("fb04"),p=a("2f62"),u=a("41d1"),m={metaInfo:function(){return{title:this.$route.meta.title||"熊猫博士",meta:[{name:"keywords",content:this.$route.meta.title+",熊猫博士"}]}},name:"index",components:{DP_Popup:u["a"]},mixins:[o["a"]],props:{},data:function(){return{parameter:{user_id:"",bundleId:"",avatar:"",sentence:"",poster:"",name:""},tips:"海报正在生成...",pageQrcode_img:"",qrcodeObj:null,avatarObj:null,posterObj:null,wechatJump:"",posterData:[],showImg:!1,output_img:"",p_img:!1,a_img:!1,popup:{show:!1,title:""}}},watch:{},computed:Object(n["a"])({},Object(p["b"])({pageParameter:"getPageParameter",userInfo:"getUserInfo",browserInfo:"getBrowser"})),methods:{pageMixin_wechatJsSdkFn:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateAppMessageShareData({title:"熊猫博士送你爱心会员",desc:"领取立即免费学习",link:this.wechatJump,imgUrl:"https://business.xiongmaoboshi.com/cms_media/200.png",success:function(){}}),e.updateTimelineShareData({title:"熊猫博士识字送你爱心会员",link:this.wechatJump,imgUrl:"https://business.xiongmaoboshi.com/cms_media/200.png",success:function(){}}),t?(e.showAllNonBaseMenuItem(),e.hideMenuItems({menuList:["menuItem:copyUrl","menuItem:originPage","menuItem:openWithQQBrowser",'menuItem:share:brand"',"menuItem:openWithSafari","menuItem:copyUrl"]})):e.hideAllNonBaseMenuItem()},openPopup:function(){this.popup.show=!0},getAllImage:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.browserInfo.device.isDPApp){t.next=5;break}return t.next=3,Object(c["c"])(e.parameter.bundleId,!0);case 3:a=t.sent,e.pageQrcode_img=0===a.data.code?"data:image/jpeg;base64,"+a.data.data:"";case 5:if(!e.parameter.avatar){t.next=11;break}return t.next=8,e.getImg("avatar");case 8:t.t0=t.sent,t.next=12;break;case 11:t.t0=null;case 12:if(e.avatarObj=t.t0,!e.parameter.poster){t.next=19;break}return t.next=16,e.getImg("poster");case 16:t.t1=t.sent,t.next=20;break;case 19:t.t1=null;case 20:return e.posterObj=t.t1,t.next=23,Object(c["d"])(e.parameter.user_id);case 23:s=t.sent,e.qrcodeObj=new Image,e.qrcodeObj.src=0===s.data.code?"data:image/jpeg;base64,"+s.data.data.qrCodeBase64:"",0===s.data.code&&(e.wechatJump=s.data.data.contentUrl,e.pageMixin_wechatJsSdk&&e.pageMixin_wechatJsSdkFn(e.pageMixin_wechatJsSdk,!0)),e.qrcodeObj.onload=function(){e.drawPoster()};case 28:case"end":return t.stop()}}),t)})))()},drawPoster:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,s,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e.$refs.canvas,s=640,r=1138,a.width=s,a.height=r,i=a.getContext("2d"),e.posterObj?i.drawImage(e.posterObj,0,0,s,r):console.log("无海报信息"),i.fillStyle="white",i.font="22px Helvetica, Arial, sans-serif",e.parameter.name?i.fillText(e.parameter.name,130,65):console.log("无用户昵称"),i.font="18px Helvetica, Arial, sans-serif",e.parameter.sentence?e.parameter.name?i.fillText(e.parameter.sentence,130,95):i.fillText(e.parameter.sentence,65,65):console.log("无分享语句"),e.avatarObj?i.drawImage(e.avatarObj,30,30,80,80):console.log("无头像信息"),i.drawImage(e.qrcodeObj,430,936,150,150),e.output_img=a.toDataURL();case 15:case"end":return t.stop()}}),t)})))()},getImg:function(e){var t=this,a=this.$refs[e];return new Promise((function(e,s){a.complete?(e(a),console.log("图片加载已完成")):(a.onload=function(){e(a)},a.onerror=function(){t.dp_Tips("提示","海报加载错误 请重试"),s("图片加载失败")},a.onabort=function(){t.dp_Tips("提示","海报加载失败 请重试"),s("图片取消加载")})}))}},created:function(){},mounted:function(){var e=this.$route.query.parameter;if(e){var t=JSON.parse(decodeURIComponent(e));Object.assign(this.parameter,t),console.log("参数信息：",this.parameter),this.getAllImage()}else this.tips="参数错误",this.showImg=!1}},l=m,d=(a("f856"),a("2877")),g=Object(d["a"])(l,s,r,!1,null,"71d30dec",null);t["default"]=g.exports},f856:function(e,t,a){"use strict";var s=a("53d8"),r=a.n(s);r.a}}]);
//# sourceMappingURL=chunk-1fd0f9c6.e2092b53.js.map