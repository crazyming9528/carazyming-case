webpackJsonp([10],{PANX:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("Xxa5"),l=t.n(r),n=t("exGp"),s=t.n(n),i=t("//Fk"),c=t.n(i),o=t("RAp7"),u=t("/tHx"),h=t("/6my"),p=t("BCwc"),d=t("99Ta"),m={name:"OperatorList",components:{TableToolsBox:h.a},mixins:[o.a,u.a],props:{},data:function(){return{dialogTitle:"",editId:0,dialogFormVisible:!1,formLabelWidth:"120px",form:{name:"",description:"",url:"",type:"1",imgurl:""},tableBatchOperation:[{text:"删除",value:"delete"},{text:"封禁",value:"ban"},{text:"取消封禁",value:"cancelBan"}],tableBatchOperate:"",tableData:[],tableSort:{sortBy:"",sort:"desc"},searchParameterSource:{status:[],searchBy:[],gender:[],role:[]},searchParameterRes:{status:"",gender:"",role:"",searchBy:"",searchValue:"",dateRange:""},uploadUrl:window.API_server.API_ADDRESS+"/single_upload",headers:{Authorization:""},dialog:{title:"",display:!1},changeRole:{uid:"",username:"",rid:""}}},watch:{},computed:{},methods:{tableRowClickFn:function(e,a,t){console.log(e)},tableSortFn:function(e){this.tableSort.sortBy=e.prop,"ascending"===e.order?this.tableSort.sort="asc":this.tableSort.sort="desc",this.getTableDataSource()},tableBatchFn:function(){if(""!==this.tableBatchOperate&&0!==this.tableMixin_multipleSelection.length){var e=this.tableMixin_multipleSelection.map(function(e){return e.uid});switch(this.tableBatchOperate){case"delete":this.deleteFn(e);break;case"ban":this.changeOperatorStatusFn(e,"ban");break;case"cancelBan":this.changeOperatorStatusFn(e,"cancelBan")}}else this.ele_alert("请勾选要处理的数据并选择批量处理的操作类型！","warning")},getSearchParameters:function(){var e=this;return new c.a(function(a,t){Object(d.a)("OperatorManage").then(function(r){var l=r.data,n=l.data,s=l.code;l.message;1e4===s?(e.searchParameterSource.searchBy=n.searchBy||[],e.searchParameterRes.searchBy=e.searchParameterSource.searchBy[0]?e.searchParameterSource.searchBy[0].value:"",e.searchParameterSource.status=n.status||[],e.searchParameterSource.gender=n.gender||[],e.searchParameterSource.role=n.role||[],a(!0)):t()})})},getTableDataSource:function(){var e=this;return this.tableMixin_tableLoading=!0,new c.a(function(a,t){Object(p.b)(e.tableMixin_currentPage,e.tableMixin_pageSize,e.tableSort.sortBy,e.tableSort.sort,e.searchParameterRes.status,e.searchParameterRes.role,e.searchParameterRes.searchBy,e.searchParameterRes.searchValue,e.searchParameterRes.dateRange[0],e.searchParameterRes.dateRange[1]).then(function(t){var r=t.data,l=r.data,n=r.code;r.message;1e4===n&&(e.tableData=l.data.map(function(e){return e.status="1"==e.status,e}),e.tableMixin_total=l.total,a(!0))}).catch(function(e){t(e)}).finally(function(){e.tableMixin_tableLoading=!1})})},clearSearchParameterRes:function(){for(var e in this.searchParameterRes)this.searchParameterRes.hasOwnProperty(e)&&(this.searchParameterRes[e]="")},editFn:function(e){console.log(e.uid),this.ele_alert("无权编辑!","warning")},roleFn:function(e){console.log(e.uid),this.changeRole.uid=e.uid,this.changeRole.username=e.username,this.dialog.title="修改 "+this.changeRole.username+" 的角色",this.dialog.display=!0},changeOperatorStatusFn:function(e,a){var t=this,r=[];Array.isArray(e)?r=e:(r.push(e.uid),a=!0===a[0]?"cancelBan":"ban");var l="cancelBan"===a?"取消封禁":"封禁";this.ele_confirm("你确定"+l+"这"+r.length+"个用户吗？","warning",function(){t.getTableDataSource()})},deleteFn:function(e){var a=this,t=[];Array.isArray(e)?t=e:t.push(e.uid),this.ele_confirm("你确定删除这"+t.length+"个用户吗？","warning",function(){console.log("删除成功"),a.getTableDataSource()})},refreshFn:function(){this.tableMixin_resetCurrentPage(),this.clearSearchParameterRes(),this.getData().then(function(e){console.log("网络请求成功")}).finally(function(){})},searchFn:function(){this.tableMixin_resetCurrentPage(),this.getTableDataSource()},changeRoleFn:function(){var e=this;Object(p.a)(this.changeRole.uid,this.changeRole.rid).then(function(a){var t=a.data,r=(t.data,t.code);t.message;1e4===r&&(e.ele_notify("修改角色成功","success"),e.dialog.display=!1,e.getTableDataSource())})},getData:function(){var e=this;return s()(l.a.mark(function a(){return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.getSearchParameters();case 2:return a.next=4,e.getTableDataSource();case 4:case"end":return a.stop()}},a,e)}))()}},created:function(){this.getData().then(function(e){console.log("网络请求成功")}).catch(function(e){console.log(e)}).finally(function(){})},mounted:function(){}},g={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"page_wrapper"},[t("div",{staticClass:"main_body animated  fadeIn"},[t("el-row",{staticClass:"head_area  panel_area"},[t("el-col",{attrs:{span:24}},[t("span",{staticClass:"title"},[e._v("操作员列表")]),e._v(" "),t("span",{staticClass:"description"},[e._v(e._s(this.$store.getters.systemInfo.title)+" 用户管理")])])],1),e._v(" "),t("el-row",{staticClass:"panel_area"},[t("el-col",{attrs:{span:24}},[t("TableToolsBox",{attrs:{"show-add":!0,"show-chart":!1,"show-down-load":!1},on:{refresh:e.refreshFn,search:e.searchFn}},[t("template",{slot:"search"},[t("el-select",{staticClass:"search_param",staticStyle:{width:"150px"},attrs:{placeholder:"筛选角色"},model:{value:e.searchParameterRes.role,callback:function(a){e.$set(e.searchParameterRes,"role",a)},expression:"searchParameterRes.role"}},e._l(this.searchParameterSource.role,function(e,a){return t("el-option",{key:a,attrs:{label:e.role_name,value:e.rid}})}),1),e._v(" "),t("el-select",{staticClass:"search_param",staticStyle:{width:"150px"},attrs:{placeholder:"筛选性别"},model:{value:e.searchParameterRes.gender,callback:function(a){e.$set(e.searchParameterRes,"gender",a)},expression:"searchParameterRes.gender"}},e._l(this.searchParameterSource.gender,function(e,a){return t("el-option",{key:a,attrs:{label:e.text,value:e.value}})}),1),e._v(" "),t("el-select",{staticClass:"search_param",staticStyle:{width:"150px"},attrs:{placeholder:"筛选状态"},model:{value:e.searchParameterRes.status,callback:function(a){e.$set(e.searchParameterRes,"status",a)},expression:"searchParameterRes.status"}},e._l(this.searchParameterSource.status,function(e,a){return t("el-option",{key:a,attrs:{label:e.text,value:e.value}})}),1),e._v(" "),t("el-input",{staticClass:"input-with-select search_param",staticStyle:{width:"250px"},attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.searchParameterRes.searchValue,callback:function(a){e.$set(e.searchParameterRes,"searchValue","string"==typeof a?a.trim():a)},expression:"searchParameterRes.searchValue"}},[t("el-select",{staticStyle:{width:"120px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.searchParameterRes.searchBy,callback:function(a){e.$set(e.searchParameterRes,"searchBy",a)},expression:"searchParameterRes.searchBy"}},e._l(this.searchParameterSource.searchBy,function(e,a){return t("el-option",{key:a,attrs:{label:e.text,value:e.value}})}),1)],1)],1)],2)],1)],1),e._v(" "),t("el-row",{staticClass:"panel_area",attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-card",{staticClass:"box-card padding_none"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableMixin_tableLoading,expression:"tableMixin_tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-style":{cursor:"pointer"},border:"","row-key":"id",stripe:""},on:{"row-click":e.tableRowClickFn,"selection-change":e.tableMixin_handleSelectionChange,"sort-change":e.tableSortFn}},[t("el-table-column",{attrs:{align:"center",type:"selection"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"ID",prop:"uid",width:"100"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"用户名",prop:"username"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"姓名",prop:"real_name"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"角色",prop:"role_name"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"最后一次登录IP",prop:"last_login_ip",width:"180"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"最后一次登录时间",prop:"last_login_time",sortable:"custom",width:"180"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"create_time",sortable:"custom",width:"180"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"状态",prop:"status",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"active-color":"#13ce66","active-text":"正常","inactive-color":"#ff4949","inactive-text":"封禁"},on:{change:function(t){return e.changeOperatorStatusFn(a.row,arguments)}},model:{value:a.row.status,callback:function(t){e.$set(a.row,"status",t)},expression:"scope.row.status"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{plain:"",size:"mini",type:"primary"},on:{click:function(t){return t.stopPropagation(),e.editFn(a.row)}}},[e._v("编辑")]),e._v(" "),t("el-button",{attrs:{plain:"",size:"mini",type:"primary"},on:{click:function(t){return t.stopPropagation(),e.roleFn(a.row)}}},[e._v("修改角色")]),e._v(" "),t("el-button",{attrs:{plain:"",size:"mini",type:"danger"},on:{click:function(t){return t.stopPropagation(),e.deleteFn(a.row)}}},[e._v("删除")])]}}])})],1)],1)],1)],1),e._v(" "),t("el-row",{staticClass:"panel_area"},[t("el-col",{attrs:{span:12}},[t("span",{staticStyle:{color:"gray","font-size":"14px"}},[e._v("批量操作:")]),e._v(" "),t("el-select",{attrs:{placeholder:"请选择批量操作",size:"small"},model:{value:e.tableBatchOperate,callback:function(a){e.tableBatchOperate=a},expression:"tableBatchOperate"}},e._l(e.tableBatchOperation,function(e,a){return t("el-option",{key:a,attrs:{label:e.text,value:e.value}})}),1),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.tableBatchFn}},[e._v("确定")])],1),e._v(" "),t("el-col",{attrs:{span:12}},[t("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.tableMixin_currentPage,"page-size":e.tableMixin_pageSize,"page-sizes":e.tableMixin_pageSizeArr,total:e.tableMixin_total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.tableMixin_handleCurrentChange,"size-change":e.tableMixin_handleSizeChange}})],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{"close-on-click-modal":!1,title:e.dialog.title,visible:e.dialog.display},on:{"update:visible":function(a){return e.$set(e.dialog,"display",a)}}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"请选择角色"}},[t("el-select",{staticClass:"search_param",staticStyle:{width:"300px"},attrs:{placeholder:"选择角色"},model:{value:e.changeRole.rid,callback:function(a){e.$set(e.changeRole,"rid",a)},expression:"changeRole.rid"}},e._l(this.searchParameterSource.role,function(e,a){return t("el-option",{key:a,attrs:{label:e.role_name,value:e.rid}})}),1),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.changeRoleFn}},[e._v("确 定")]),e._v(" "),t("el-button",{on:{click:function(a){e.dialog.display=!1}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var b=t("VU/8")(m,g,!1,function(e){t("k+Vv")},"data-v-20c5cc82",null);a.default=b.exports},"k+Vv":function(e,a){}});
//# sourceMappingURL=10.4f21151cfe97fe0904a1.js.map